name: Automacao Medical Insight 24h

on:
  schedule:
    # Este comando 'cron' faz o robô rodar a cada hora cheia (00:00, 01:00, etc)
    - cron: '0 * * * *'
  workflow_dispatch: # Permite que você rode manualmente pelo site do GitHub se quiser

jobs:
  executar_curadoria:
    runs-on: ubuntu-latest
    steps:
      - name: Baixando o código do projeto
        uses: actions/checkout@v3

      - name: Instalando o Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Instalando as dependências (Bibliotecas)
        run: pip install -r requirements.txt

      - name: Rodando o Robô Worker
        run: python worker.py
        env:
          # Conectando as chaves de segurança (Secrets) que vamos configurar no Passo 3
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          EMAIL_REMETENTE: ${{ secrets.EMAIL_REMETENTE }}
          EMAIL_SENHA: ${{ secrets.EMAIL_SENHA }}
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
          ENTREZ_EMAIL: ${{ secrets.ENTREZ_EMAIL }}